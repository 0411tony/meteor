<head>
  <title>tinytest WIP</title>
</head>

<body>
  {{> header }}
  {{> results }}
</body>

<template name="header">
  Passed: {{passed_count}}<br>
  Failed: {{failed_count}} ({{expected_failed_count}})<br>
  Total: {{total_count}}<br>
  {{#with exception_count}}
    {{#if this}}
      Exceptions: {{this}}<br>
    {{/if}}
  {{/with}}
  {{> rerun_all_button }}
</template>

<template name="results">
  {{#each results}}
    {{#if type_is "begin"}}
      <div class="begin">{{name}}</div>
    {{else}}
      {{#if type_is "fail"}}
        {{> fail}}
      {{else}}
        {{#if type_is "exception"}}
          {{> exception }}
        {{else}}
          <div class="{{type}}">{{message}}</div>
        {{/if}}
      {{/if}}
    {{/if}}
  {{/each}}
</template>

<template name="rerun_all_button">
  <div><div class="rerunall">Rerun all</div></div>
</template>

<template name="exception">
  <div class="exception">Exception: {{message}}
    {{stack}}
    <div class="rerun">Rerun and stop here</div>
  </div>
</template>

<template name="fail">
  {{#if expected}}
    <span>(expected failure)</span>
  {{else}}
    {{#with details}}
      {{#if type_is "assert"}}
        <div class="assert">
          {{message}}
          <div class="expected">Expected:
            {{#if not}}Any value but{{/if}} {{expected}}</div>
          <div class="actual">Actual: {{actual}}</div>
        </div>
      {{else}}
        <div class="{{type}}">Fail: {{type}} &mdash; {{message}}</div>
      {{/if}}
      <span>
        <div class="rerun">Rerun and stop here</a>
      </span>
    {{/with}}
  {{/if}}
</template>

<template name="test_renderList_each">
  Before{{render_count}}
  {{#each data}}
    {{name}}{{weather "here"}}
  {{/each}}
  Middle
  {{#each data2}}
    {{name}}
  {{else}}
    Else
  {{/each}}
  After
</template>
